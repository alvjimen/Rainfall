#include <stdlib.h>

char *service;
char *auth;
int main()
{
    char buffer[];
    int counter;
    char *tmp;
    register int pos;
    //160 - 
    do 
    {
	printf("%p, %p ^J", service, auth);
	if (fgets(buffer, 128, stdin) == NULL)
	    break;
	if  (!memcmp("auth ", buffer,  5))
	{
	    auth = malloc(4);
	    *auth = '\0';

	    // Search for next null
	    counter= -1;
	    pos = 0;
	    tmp = &buffer[0] + 5;
	    while (*tmp++ && counter)
	    {
		pos++;
		counter--;
	    }
	    pos = ~counter;
	    pos--;
	    if (pos > 30)
		continue;//
	    tmp = &buffer[0] + 5;
	    strcpy(auth, tmp);
	    continue
	    
	}
	if (!memcmp("reset", buffer, 5))
	{
	    free(auth);
	}
	if (!memcmp("service ", buffer, 6))
	{
	    tmp = &buffer[0] + 7;
	    service=strdup(tmp);
	}
	
	    
    }
    while ();
}
